---
description: Standards for layer-specific RGB indicators in ZMK
globs: 
alwaysApply: false
---
# ZMK Layer RGB Indicator Standards

<rule>
name: zmk_layer_rgb_indicators
description: Ensures consistent implementation of layer-specific RGB indicators in ZMK firmware

filters:
  - type: file_extension
    pattern: "\\.keymap$"
  - type: content
    pattern: "(?s).*layer.*rgb.*"

actions:
  - type: suggest
    message: |
      When implementing layer-specific RGB indicators:

      1. Color Definitions:
         ```c
         // Define colors at the top of the file
         #define INDICATOR_COLOR 0x800080  // Purple
         #define LED_OFF 0x000000         // Black
         ```

      2. Layer-Specific Behaviors:
         ```c
         // One behavior per layer with unique LED indices
         layer0_rgb: layer0_rgb {
             compatible = "zmk,behavior-rgb-underglow";
             #binding-cells = <2>;
             led-index = <index>;  // Unique per layer
             default-color = <INDICATOR_COLOR>;
             off-color = <LED_OFF>;
         };
         ```

      3. Layer Implementation:
         ```c
         default_layer {
             bindings = <
                 // Place indicator at specific position
                 &layer0_rgb 0 0
             >;
         };
         ```

      4. Best Practices:
         - Use consistent LED positions relative to layer
         - Document LED indices in comments
         - Use clear color definitions
         - Maintain visual consistency across layers

examples:
  - input: |
      // Bad - Inconsistent positioning
      default_layer {
          &rgb_ind 0 0 at R1C1
      };
      lower_layer {
          &rgb_ind 0 0 at R3C4  // Different position
      };
      
      // Good - Consistent relative positioning
      default_layer {
          &layer0_rgb 0 0 at R2C6  // Consistent position
      };
      lower_layer {
          &layer1_rgb 0 0 at R2C5  // One position left
      };
    output: "Maintain consistent relative LED positions for better UX"

metadata:
  priority: medium
  version: 1.0
  related_rules:
    - zmk_rgb_configuration
    - zmk_layer_standards
  responsibility: "Layer-specific RGB indicator implementation"
  standard_patterns:
    layer_rgb_behavior:
      compatible: "zmk,behavior-rgb-underglow"
      cells: 2
      properties:
        - led-index
        - default-color
        - off-color
    positioning:
      pattern: "Consistent relative positions between layers"
      example: "R2C6 → R2C5 → R2C4"
</rule> 